<!DOCTYPE html>
<html>
<head>
  <title>Club Attendance Scanner</title>
  <script src="https://unpkg.com/html5-qrcode" type="text/javascript"></script>
  <style>
    body { font-family: sans-serif; padding: 20px; text-align: center; }
    #reader { width: 300px; height: 300px; margin: auto; }
    #log { margin-top: 20px; }
  </style>
</head>
<body>
  <h1>Attendance Scanner</h1>
  <div id="reader"></div>
  <div id="log"></div>

  <script>
    const logDiv = document.getElementById('log');

    function logScan(data) {
      const timestamp = new Date().toISOString();

      // Log locally (you can replace this with a request to a backend or Google Sheets API)
      const entry = `Scanned ID: ${data} | Time: ${timestamp}`;
      console.log(entry);
      logDiv.innerHTML = `<p>${entry}</p>` + logDiv.innerHTML;

      // TODO: Replace with fetch() to send data to a backend/Google Sheets
    }

    const scanner = new Html5Qrcode("reader");
    scanner.start(
      { facingMode: "environment" },
      {
        fps: 10,
        qrbox: 250
      },
      (decodedText) => {
        logScan(decodedText);
      },
      (errorMessage) => {
        // ignore errors
      }
    ).catch(err => {
      console.error("Camera start error:", err);
      logDiv.innerHTML = `<p style="color:red;">Camera Error: ${err}</p>`;
    });

  </script>
</body>
</html>
